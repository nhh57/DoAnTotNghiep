<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="76x76"
          th:href="@{/admin/assets/img/apple-icon.png}">
    <link rel="icon" type="image/png"
          th:href="@{/admin/assets/img/favicon.png}">
    <title>ADMIN</title>
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css"
          href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700"/>
    <!-- Nucleo Icons -->
    <link
            th:href="@{/admin/assets/css/nucleo-icons.css}"
            rel="stylesheet"/>
    <link
            th:href="@{/admin/assets/css/nucleo-svg.css}"
            rel="stylesheet"/>
    <!-- Font Awesome Icons -->
    <script src="https://kit.fontawesome.com/42d5adcbca.js"
            crossorigin="anonymous"></script>
    <!-- Material Icons -->
    <link
            href="https://fonts.googleapis.com/icon?family=Material+Icons+Round"
            rel="stylesheet">
    <!-- CSS Files -->
    <link id="pagestyle"
          th:href="@{/admin/assets/css/material-dashboard.css?v=3.0.0}"
          rel="stylesheet"/>
    <link
            th:href="@{/admin/custom/css/index.css}"
            rel="stylesheet"/>

</head>

<body class="g-sidenav-show  bg-gray-200">
<aside
        class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3   bg-gradient-dark"
        id="sidenav-main">
    <div class="sidenav-header">
        <i
                class="fas fa-times p-3 cursor-pointer text-white opacity-5 position-absolute end-0 top-0 d-none d-xl-none"
                aria-hidden="true" id="iconSidenav"></i> <a class="navbar-brand m-0"
                                                            th:href="@{/mvc/admin/category}"
                                                            target="_blank"> <img
            th:src="@{/admin/assets/img/logo-ct.png}"
            class="navbar-brand-img h-100" alt="main_logo"> <span
            class="ms-1 font-weight-bold text-white">ADMIN</span>
    </a>
    </div>
    <hr class="horizontal light mt-0 mb-2">
    <div class="collapse navbar-collapse  w-auto  max-height-vh-100"
         id="sidenav-collapse-main">
        <ul class="navbar-nav">
            <li class="nav-item"><a
                    class="nav-link text-white"
                    th:href="@{/mvc/admin/category}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">dashboard</i>
                </div>
                <span class="nav-link-text ms-1">Quản lý loại sản phẩm</span>
            </a></li>
            <li class="nav-item"><a
                    class="nav-link text-white"
                    th:href="@{/mvc/admin/brand}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">table_view</i>
                </div>
                <span class="nav-link-text ms-1">Quản lý hãng</span>
            </a></li>
            <li class="nav-item"><a
                    class="nav-link text-white"
                    th:href="@{/mvc/admin/product}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">assignment</i>
                </div>
                <span class="nav-link-text ms-1">Quản lý sản phẩm</span>
            </a></li>
            <li class="nav-item"><a class="nav-link text-white " th:href="@{/mvc/admin/account}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">person</i>
                </div>
                <span class="nav-link-text ms-1">Quản lý khách hàng</span>
            </a></li>
            <li class="nav-item"><a
                    class="nav-link text-white"
                    th:href="@{/mvc/admin/order}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">receipt_long</i>
                </div>
                <span class="nav-link-text ms-1">Quản lý hóa đơn</span>
            </a></li>
            <li class="nav-item"><a
                    class="nav-link text-white"
                    th:href="@{/mvc/admin/sale}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">view_in_ar</i>
                </div>
                <span class="nav-link-text ms-1">Quản lý khuyến mãi</span>
            </a></li>
            <li class="nav-item"><a
                    class="nav-link text-white active bg-gradient-primary"
                    th:href="@{/mvc/admin/report}">
                <div
                        class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">format_textdirection_r_to_l</i>
                </div>
                <span class="nav-link-text ms-1">Thống kê</span>
            </a></li>
            <li class="nav-item"><a class="nav-link text-white "
                                    href="/mvc/admin/logout?urlReturn=report">
                <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                    <i class="material-icons opacity-10">logout</i>
                </div>
                <span class="nav-link-text ms-1">Đăng xuất</span>
            </a></li>
        </ul>
    </div>
</aside>
<main
        class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
    <!-- Navbar -->
    <nav
            class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl"
            id="navbarBlur" navbar-scroll="true">
        <div class="container-fluid py-1 px-3">
            <nav aria-label="breadcrumb">
                <ol
                        class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
                    <li class="breadcrumb-item text-sm"><a
                            class="opacity-5 text-dark" href="javascript:;">Admin</a></li>
                    <li class="breadcrumb-item text-sm text-dark active"
                        aria-current="page">Report
                    </li>
                </ol>
                <h6 class="font-weight-bolder mb-0">Thống kê doanh thu theo năm</h6>
            </nav>
            <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4"
                 id="navbar">
                <form action="/mvc/admin/brand" method="get" class="ms-md-auto pe-md-3 d-flex align-items-center">
                    <div class="input-group input-group-outline">
                    </div>
                </form>
                <ul class="navbar-nav  justify-content-end">
                    <div style="margin-top: 20px; float:right" class="dropdown nav-item d-flex align-items-center">
                        <i class="fa fa-user dropbtn btn btn-success dropdown-toggle"
                           aria-hidden="true" id="dropdownMenuButton"
                           data-toggle="dropdown" aria-haspopup="true"
                           aria-expanded="false"> Hi, [[${admin.username}]]</i>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="/mvc/admin/logout?urlReturn=report">Đăng
                                xuất</a>

                        </div>
                    </div>
                    <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
                        <a href="javascript:;" class="nav-link text-body p-0"
                           id="iconNavbarSidenav">
                            <div class="sidenav-toggler-inner">
                                <i class="sidenav-toggler-line"></i> <i
                                    class="sidenav-toggler-line"></i> <i
                                    class="sidenav-toggler-line"></i>
                            </div>
                        </a>
                </ul>
            </div>
        </div>
    </nav>
    <!-- End Navbar -->
    <div style="margin:0 20px;">
        <ul class="nav nav-pills">
            <li class="nav-item">
                <a class="nav-link nav-custom" href="/mvc/admin/report?tag=1">Sản phẩm</a>
            </li>
            <li class="nav-item">
                <a class="nav-link nav-custom" href="/mvc/admin/report?tag=2">Khách hàng</a>
            </li>
            <li class="nav-item">
                <a class="nav-link nav-custom activeTabCustom" href="/mvc/admin/report?tag=3">Thời gian</a>
            </li>
        </ul>
    </div>
    <form>
        <input type="hidden" name="tabPanelIndex" id="idTab" th:value="${tabPanelIndex}">
    </form>
    <div style="margin:20px;">
        <label for="loaiThoiGian">
            Loại thời gian:
        </label>
        <select id="loaiThoiGian" class="btn-infor-custom">
            <option value="year">Báo cáo theo năm</option>
            <option value="month">Báo cáo theo tháng</option>
            <option selected value="stage">Khoảng thời gian</option>
        </select>
        <span hidden="true" id="filterYear">
            <label for="yColumn">Loại cột:</label>
            <select id="yColumn" class="btn-secondary-custom">
                <option value="1">Tháng</option>
                <option value="2">Quý</option>
            </select>
            <select id="yYear" class="btn-secondary-custom">
                <th:block th:each="i: ${#numbers.sequence(2022,report.oldestYear)}">
                    <option th:value="${i}" th:text="'Năm '+${i}"></option>
                </th:block>
            </select>
            <button id="yFilter" style="margin-top: 2px;" class="btn btn-success">Lọc</button>
        </span>
        <span hidden="true" id="filterMonth">
            <select id="mYear" class="btn-secondary-custom">
                <th:block th:each="i: ${#numbers.sequence(2022,report.oldestYear)}">
                    <option th:value="${i}" th:text="'Năm '+${i}"></option>
                </th:block>
            </select>
            <select id="mMonth" class="btn-secondary-custom">
                <th:block th:each="i: ${#numbers.sequence(1,12)}">
                    <option th:value="${i}" th:text="'Tháng '+${i}"></option>
                </th:block>
            </select>
            <button id="mFilter" style="margin-top: 2px;" class="btn btn-success">Lọc</button>
        </span>
        <span id="filterStage">
            <label for="sStartDate">Từ:</label>
            <input th:value="${sStartDate}" name="sStartDate" id="sStartDate" class="dateForm" type="date">
            <label for="sEndDate">Đến:</label>
            <input th:value="${sEndDate}" name="sEndDate" id="sEndDate" class="dateForm" type="date">
            <button id="sFilter" style="margin-top: 14px;" class="btn btn-success">Lọc</button>
        </span>
    </div>
    <div class="container-fluid py-4" style="background-color:#fff">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link" href="#tongQuan" role="tab" data-toggle="tab">Tổng quan</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#chiTiet" role="tab" data-toggle="tab">Chi tiết</a>
            </li>
        </ul>
        <!-- Tab panes -->
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade" id="tongQuan">
                <div class="container-fluid py-4" style="background-color:#fff">
                    <div id="columnchart_material" style="width: 1200px; height: 600px;"></div>
                </div>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="chiTiet">
                <div class="card my-4" style="margin-top:50px !important;">
                    <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
                        <div
                                class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
                            <h6 class="text-white text-capitalize ps-3">Doanh thu tháng [[${mMonth}]] năm
                                [[${mYear}]]</h6>
                        </div>
                    </div>
                    <div class="card-body px-0 pb-2">
                        <div class="table-responsive p-0">
                            <table class="table align-items-center mb-0">
                                <thead>
                                <tr>
                                    <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                        Ngày
                                    </th>
                                    <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                        Doanh thu
                                    </th>

                                </tr>
                                </thead>
                                <tbody id="tableFilter">
                                <th:block th:each="item : ${report.listReport}">
                                    <tr>
                                        <td class="align-middle text-center text-sm">
                                            <p class="text-xs font-weight-bold mb-0">[[${item.name}]]</p>
                                        </td>
                                        <td class="align-middle text-center"><span
                                                class="text-secondary text-xs font-weight-bold">[[${#numbers.formatDecimal(item.value, 0, 'COMMA', 0, 'POINT')}]] đ</span>
                                        </td>
                                    </tr>
                                </th:block>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<script
        th:src="@{/admin/assets/js/core/popper.min.js}"></script>
<script
        th:src="@{/admin/assets/js/core/bootstrap.min.js}"></script>
<script
        th:src="@{/admin/assets/js/plugins/perfect-scrollbar.min.js}"></script>
<script
        th:src="@{/admin/assets/js/plugins/smooth-scrollbar.min.js}"></script>
<script
        th:src="@{/admin/assets/js/plugins/chartjs.min.js}"></script>
<script>
		var win = navigator.platform.indexOf('Win') > -1;
		if (win && document.querySelector('#sidenav-scrollbar')) {
			var options = {
				damping : '0.5'
			}
			Scrollbar.init(document.querySelector('#sidenav-scrollbar'),
					options);
		}


</script>
<!-- Github buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
<script
        th:src="@{/admin/assets/js/material-dashboard.min.js?v=3.0.0}"></script>
<script
        th:src="@{/admin/assets/js/customAdmin.js}"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
        src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<script th:src="@{/admin/custom/js/report.js}"></script>
<script src="https://www.gstatic.com/charts/loader.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    google.charts.load('current', {
        'packages' : [ 'bar' ]
    });
    google.charts.setOnLoadCallback(drawChart);
    var listReport = /*[[${report.getListReport()}]]*/;
    var nameChart=/*[[${report.getNameChart()}]]*/;
    var result=[];
    var title=["Ngày","Doanh thu"];
    result.push(title);
    listReport.forEach(function(item){
        var arrayTemp=[];
        arrayTemp.push(item.name);
        arrayTemp.push(item.value);
        result.push(arrayTemp);
    });
    function drawChart() {
        var data = google.visualization
                .arrayToDataTable(result);
        var options = {
            chart : {
                title : 'Thống kê doanh thu',
                subtitle : nameChart
            },
            vAxis: {
              title: "Doanh thu",
            },
            hAxis: {
                title: "Ngày",
				slantedText: true,
				slantedTextAngle: 45,
			}
        };

        var chart = new google.charts.Bar(document
                .getElementById('columnchart_material'));

        chart.draw(data, google.charts.Bar.convertOptions(options));
    }
    /*]]>*/



</script>
</body>

</html>